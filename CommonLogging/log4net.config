<log4net>
  
  <appender name="Console" type="log4net.Appender.ConsoleAppender">
    <layout type="log4net.Layout.PatternLayout">
      <conversionPattern value="%utcdate [%-5thread] [%-5level] %logger - %message - %property{caller}%newline%exception" />
    </layout>
  </appender>

  <appender name="RequestConsole" type="log4net.Appender.ConsoleAppender">
    <layout type="log4net.Layout.PatternLayout">
      <conversionPattern value="%utcdate [%-5thread] [%-5level] $property{request}%newline%newline" />
    </layout>
  </appender>

  <appender name="Blob" type="CommonLogging.Appenders.AzureBlobStorageAppender, CommonLogging">
    
    <filter type="log4net.Filter.LevelRangeFilter">
      <levelMin value="DEBUG" />
      <levelMax value="FATAL" />
      <acceptOnMatch value ="true" />
    </filter>
    
    <filter type="log4net.Filter.PropertyFilter">
      <key value="BlobDump" />
      <stringToMatch value="1" />
      <acceptOnMatch value="true" />
    </filter>
    
    <filter type="log4net.Filter.DenyAllFilter" />
    
    <layout type="log4net.Layout.PatternLayout">
      <conversionPattern value="" />
    </layout>
    
  </appender>

  <root>
    <level value="ALL" />
    <appender-ref ref="Console" />
    <appender-ref ref="Blob" />
  </root>

  <logger name="System.Net.Http.HttpRequestMessage">
    <level value="INFO" />
    <appender-ref ref="RequestConsole" />
  </logger>
  
</log4net>